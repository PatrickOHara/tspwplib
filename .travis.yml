language: python
name: "python unit tests & code style"
python:
  - "3.6"
  - "3.8"
cache: pip
addons:
  apt:
    update: true
    sources:
      # add the graph-tool source for apt-get
      - sourceline: "deb [ arch=amd64 ] https://downloads.skewed.de/apt focal main"
        key_url: https://keys.openpgp.org/vks/v1/by-fingerprint/793CEFE14DBC851A2BFB1222612DEFB798507F25
    packages:
      - python3-graph-tool
env:
  - TSPLIB_ROOT="../tsplib95/archives/problems/tsp" OPLIB_ROOT="../OPLib/"
before_install:
  - git clone https://github.com/bcamath-ds/OPLib.git ../OPLib
  - git clone https://github.com/rhgrant10/tsplib95.git ../tsplib95
install:
  - pip install .
  - pip install -r requirements.txt
script:
  # Check black formatting would not make any chages
  - black --check */
  # pylint provides stricter linting
  - pylint --rcfile .pylintrc setup.py tspwplib tests/*
  # type hinting
  - mypy --config-file .mypy.ini tspwplib
  # Run unit tests
  - python -m pytest
